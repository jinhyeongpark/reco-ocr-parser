## 설계 문서 (Design Document)
본 문서는 비정형 OCR 데이터에서 핵심 계량 정보를 추출하기 위한 시스템 설계 및 파싱 전략을 기술합니다.

### 1. 데이터 분석 및 도메인 모델링
제공된 4종의 샘플 데이터를 분석한 결과, 문서 명칭(증명서, 확인서, 표 등)은 상이하나 추출 대상인 핵심 필드(차량번호, 중량 정보)의 본질은 동일함을 확인했습니다.

### 2. 핵심 파싱 전략 (Parsing Strategy)
**차량번호 추출: [Label-First + Format Validation]**
- 유연한 레이블 매칭: 차량번호, 차번호, 차량 No. 등 가변적인 레이블 뒤에 오는 데이터를 낚아챕니다.
- 노이즈 허용 범위 설계: OCR의 자간 인식 오류(띄어쓰기)를 고려하여 레이블 뒤 최대 15자까지 데이터를 확보한 후 공백을 제거합니다.
- 규격 기반 필터링: 확보된 데이터 중 국내 자동차 번호판 표준 규격(\d{2,3}[가-힣]\d{4} 또는 구형 \d{4})에 부합하는 패턴만 최종 추출하여 정확도를 높였습니다.

**중량 데이터 추출: [Reverse Tracking from 'kg']**
- 역추적 앵커링: 라벨의 오타(예: 품종명랑)나 위치 변동에 구애받지 않도록, 가장 명확한 단위인 kg를 기점으로 역추적하여 데이터를 탐색합니다.
- 구분자 기반 시간 노이즈 제거: 중량 숫자와 혼재되기 쉬운 시간 정보(HH:mm:ss)를 제거하기 위해 구분자별 분기 처리를 적용합니다.
  - '분' 구분자: '분' 앞의 모든 텍스트를 절단하여 시간 정보를 원천 차단합니다.
  - ':' 구분자: 숫자와 콜론이 결합된 시간 패턴(\d:\d)만 정밀 타격하여 제거함으로써, 중량 데이터의 앞자리가 유실되는 현상(예: 5010 -> 10)을 방지합니다.
- 데이터 구조화: 추출된 중량 값의 개수에 따라 비즈니스 규칙(3개: 총/공차/실, 2개: 총/실)을 적용하여 필드를 매핑합니다.

### 3. 신뢰도(Confidence) 및 예외 처리
- Confidence 필터링: OCR 엔진이 제공하는 신뢰도 점수가 0.6 미만이거나 중량 데이터가 전혀 검출되지 않은 경우 needsReview 플래그를 true로 설정하여 수동 검토를 유도합니다.
- 데이터 정규화: 콤마(,), 공백 등 숫자 이외의 모든 문자를 정제하여 Double 타입으로 변환함으로써 데이터의 활용성을 확보했습니다.

### 4. 시스템 아키텍처 및 유지보수
- 관심사의 분리: 파싱 로직(Service), 데이터 검증(Domain), 외부 설정(YAML)을 철저히 분리하여 양식이 추가되더라도 기존 코드를 최소한으로 수정하도록 설계
- 로깅 및 추적: DEBUG 레벨 로그를 통해 원본 텍스트와 추출된 값, 그리고 Confidence 점수를 남겨 파싱 실패 원인을 즉각 파악
